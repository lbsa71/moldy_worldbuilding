<!-- src/components/Game.astro -->
---
---
<div class="game-container">
    <canvas id="gameCanvas"></canvas>
    <div id="statsOverlay">
        <div>Renderer: <span id="rendererType">Loading...</span></div>
        <div>FPS: <span id="fpsCounter">0</span></div>
    </div>
</div>

<!-- Load WASM module -->
<script is:inline src="/wasm/release.js"></script>

<script>
    import { GameScene } from './GameScene';
    
    Promise.all([
        new Promise(resolve => window.addEventListener('load', resolve))
    ]).then(async () => {
        const canvas = document.getElementById('gameCanvas') as HTMLCanvasElement;
        if (canvas) {
            const game = new GameScene(canvas);
            await game.run();
            
            // Update renderer type
            const rendererType = document.getElementById('rendererType');
            if (rendererType) {
                rendererType.textContent = game.getRendererType();
            }

            // Update FPS counter
            const fpsCounter = document.getElementById('fpsCounter');
            if (fpsCounter) {
                setInterval(() => {
                    fpsCounter.textContent = game.getFps().toFixed(0);
                }, 1000);
            }
        }
    });
</script>

<style>
    .game-container {
        width: 100%;
        height: 100vh;
        position: relative;
    }
    
    #gameCanvas {
        width: 100%;
        height: 100%;
        touch-action: none;
    }

    #statsOverlay {
        position: absolute;
        top: 10px;
        left: 10px;
        background: rgba(0, 0, 0, 0.7);
        color: white;
        padding: 10px;
        border-radius: 5px;
        font-family: monospace;
        font-size: 14px;
        pointer-events: none;
    }
</style>
